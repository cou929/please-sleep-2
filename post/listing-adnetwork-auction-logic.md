{"title":"リスティング広告のオークションメカニズム","date":"2014-06-15T19:39:38+09:00","tags":["ad"]}

リスティング広告のオークションがどういうふうなメカニズムになっているのか調べた。各社のヘルプページと、基礎となっている論文があったので読んだメモ。

### BIng Ads Auction Explained

[Bing Ads Auction Explained: How Bid, Cost-per-Click and Quality Score Work Together](http://advertise.bingads.microsoft.com/en-us/blogpost/128694/bing-ads-blog/bing-ads-auction-explained-how-bid-cost-per-click-and-quality-score-work-together)

- QS (Quality Score)
  - 広告のスコア。キーワード相関性などで決まる。ただし Bid 金額は QS に影響しない。
- Ad Rank
  - 最終的な表示順。Ad Rank の降順になる。
  - Ad Rank = Bid * QS
- CPC
  - 実績値ではなく、クリック時に請求される課金額
  - CPC = Bid * Competitor’s Ad Rank / Your Ad Rank
  - Bid 額よりは下がる
    - Competitor’s Ad Rank は自分より必ず下なので、Bid 額より上がることはない
  - Bid を上げても順位が変わらない限り同じ CPC になる
  - 順位は相対的なもの。周りが金額をあげると自分の CPC も変わる
  - Ad Rank が Competitor とほぼ同じならば、CPC は Bid に限りなく値が付く。逆に Competitor と Bid 額がかけ離れていると、CPC は限りなく下がる。セカンドプライスオークションに近い考え方。
  - 上位なほど CPC が高くなるわけではない。下のランクでも上よりも CPC が高い場合がある。
    - 順位が Bid だけでなく QS からも決まるからこうなる。QS が低いけど高値で指していた場合は CPC が上がる。逆に言うとあまり関係ないキーワードに出したい場合は高値で挿さないといけない。
- Bid
  - 広告主が調整できる唯一のパラメータ
  - Bid 額は広告主が払うことができる最大額という意味で、実際はセカンドプライスオークションなどの調整が入り、もっと安値で課金される。
  - Bid 額を上げる目的はより多くのクリックを得ること。金額とクリック数が比例するようなロジックにする必要がある。そのためにオークションを採用している
  - 金額をあげるとより高い順位に広告がでる。そしてクリック数が増える
  - 順位が上昇しないかぎり、Bid 額をあげても課金される CPC は上昇しない。
  - 逆に順位に影響するパラメータが変化すると CPC が変化する。たとえば競合が Bid 額をあげると自分に課金される CPC が上がることもある
- QS (Quality Score)
  - QS があがると同じ表示順位ならば CPC が下がる、という関係
  - QS を決める要素は
    - Keyword Relevance
      - KWR (Keyword Relevance, キーワード相関性)。つまりどれだけクリックされるかで、CTR と等しい。
      - 同時に同じ順位に広告を出すことはできないので、各広告主の CTR を normalize して、オークション時に使用する。オークションで使われる CTR はこのように相対的なもので、広告主レポートにでている CTR をそのままとらえて考えてはいけない。
    - Landing Page Relevance
      - LP の内容とクエリの相関性
    - Landing Page Quality
      - LP のクオリティ
      - システム全体のゴールは、ユーザーによりよい体験を提供すること。つまりクエリと関係性が高く、またその中でも最も質の高いコンテンツを提供したい。
- Competition
  - 2 位の Bid が上がると、1 位の CPC は (Bid を変更していなくても、また順位が変わらなかったとしても) あがる
  - セカンドプライスオークションの考え方。一位の広告主は順位を維持するために最低限の金額を支払う必要がある
  - Bid をあげた 2 位案件の CPC は、順位は結局変わらなかったので、支払う CPC は変化しない

#### メモ

> Ad Rank = Bid * QS

広告の選択は金額と質によって決まるというシンプルな式。

>  CPC = Bid * Competitor’s Ad Rank / Your Ad Rank

この計算式でセカンドプライスオークションを実現している部分が特に興味深い

> システム全体のゴールは、ユーザーによりよい体験を提供すること。つまりクエリと関係性が高く、またその中でも最も質の高いコンテンツを提供したい。

この部分の考え方がサーチエンジン由来を感じさせる。しかしどのような広告商品でもこの視点が大切。

#### 疑問

- CPC 計算時の `Competitor’s Ad Rank` は自分よりひとつ下位との比較だけでいいのか
  - この疑問はあとで読んだ GSP の論文で解説されていた
- KWR 評価のための CTR の normalize の方法
- 他の手法との比較とか、他の手法だとどういう問題があってどう解決しているとか、この手法に課題があるならば何かとか。論文があったら読みたい

### About the Display Network ad auction (AdWords)

[About the Display Network ad auction - AdWords Help](https://support.google.com/adwords/answer/2996564?hl=en)

- 広告の順位は Bid と QS から決まる。より質のいい広告は Bid 額がひくくても上位に出ることがある
- Bid 額は払える最高値という意味になる。実際には最低限の金額が課金される。
- Listing とくらべて、Display には以下の違いがある
  - ひとつ下位の Bid よりも上位に位置するために必要が最低額は、`incremental clicks` 分だけに適用される
  - incremental でない残りのクリックに対しては、ひとつ下位が支払っている額と同様の額を支払う
  - interest category 配信など、オークションとは別枠の追加 fee もある。その場合、Bid 額から fee 分を引いてオークションにかけられる。オークション後に fee が足し戻される。
- `incremental clicks` とは、上位の枠は下位の枠よりもどれだけクリックがでるかということ。このような枠位置によるクリック数の差に対してフェアになるようにオークションをデザインする
- Actual CPC は Bid と QS の加重平均で求められる。その重みは `incremental clicks` によって決まる。
- 全員同じ QS で、1 枠しかないオークションのケース
  - 順位は単純に Bid で決まる
  - 2 位の枠がないので、1 位の枠のクリックはすべて `incremental clicks` 扱いになる
  - 1 位になるための Bid 額は 2 位の Bid 額 + 0.01 となる
  - よって Actual CPC は 2 位の Bid 額 + 0.01 となる
- 全員同じ QS で、2 枠あるオークションのケース。また 1 位の枠は 2 位の枠の 3 倍の CTR がある。
  - 2 位の枠のクリックはすべて `incremantal clicks` あつかいになるので、2 位の Actual CPC は 3 位の Bid 額 + 0.01 になる
  - 1 位の枠は 2 位の枠の 3 倍クリックがでる。よって 1 位の枠で出たクリックのうち、3 分の 2 は `incremental clicks` とみなされ、のこりの 3 分の 1 はその案件が 2 位だったとしても得られたものとして考えられる
  - 2 位が $3, 3 位が $1 で Bid していた場合。かつ、1 位の枠で 3 クリック出た場合を考える。最初の 1 クリックは 2 位でもでたとかんがえて、2 位が払う額と同額、つまり $1.01 とする。残りの 2 クリックは `incremantal clicks` 扱いになり、$3.01 が CPC となる。この平均の `$2.34 = ($1.01 * 1 + $3.01 * 2) / 3` が 1 位の案件の Actual CPC となる。

#### メモ

- 大前提としてセカンドプライスオークションの導入は必須
- より公平な競売のために `incremental clicks` を導入している
- そして各枠の CTR がいかに正確に予測できるかが、やはり重要だ

### Internet Advertising and the Generalized Second-Price Auction: Selling Billions of Dollars Worth of Keywords

[Internet Advertising and the Generalized Second-Price Auction: Selling Billions of Dollars Worth of Keywords \(pdf\)](http://www.benedelman.org/publications/gsp-060801.pdf)

- Generalized second-price auction (GSP) というメカニズムについて
  - AdWords で導入され、Overture でも実際に運用されているもの
  - これまでに読んだ各社のオークションロジックをみても、この GSP をベースに拡張されているようだ。現在でも使われているメカニズムと言える
- ざっくりとした定式化
  - 一度のオークションで競られる広告のポジションが N 箇所、そこへ入札する bidder が K 個あるとする
  - 各ポジションの期待 CTR を alpha i として、すべてのポジションを CTR の高い順にならべる (`i < j` の場合に `alpha i > alpha j` となるようにソート)。Bid も金額順にならべて、高いものから順に CTR の高いポジションに出す。
  - i 番目に高い入札の入札額を求める関数を `b(i)` とする
  - ポジション i にでた案件の広告主が支払う額は `alpha i * b(i + 1) for i ∈ {1, …, min{K, N}}` となる。つまりじぶんよりひとつ下位の入札とだけ比較して最低限の金額に設定する方針。
    - 実際にはひとつ下位の入札額に最低限の金額を足した額になる。例えば `b(i + 1) = $2.00` の場合は `b(i) = $2.01` というように、$0.01 を加えるのが一般的らしい。

#### メモ

- ひとつ下位の入札と比べるだけなので実装もシンプルだし、それでいて類似手法とくらべて全体の収益性が高いメカニズムらしい。
- この論文が、Bing のヘルプを読んだ際の「一つ下の入札と比べるだけでいいのか」という疑問への解答になってよかった。
- 2006 年時点で Yahoo! でも Google でも実装されていて $150 billion 規模の取引が行われているという実績があるし、かつ現在も基礎はこの GSP ということで安心感がある。
- 前提知識が足りなくて理論的な部分の理解、特に均衡について説明している部分や他の手法との比較、ができなかったので、またあとで読み直したい。


### Using auction insights to compare performance

[Using auction insights to compare performance - AdWords Help](https://support.google.com/adwords/answer/2579754?hl=en)

毛色をかえて、AdWords が出しているオークションの詳細レポートについて

レポートを見たいキーワードを選択すると以下の項目のレポートが見られる。レポートは配信先のドメインごとに出るようだ。

- Average position
  - 平均順位
  - 当然順位が高いほうがクリックが出る。平均順位を出すことで Bid の増額やコンテンツの改善 (QS 向上) を促す
  - Bid が上がればプラットフォームと媒体の収益があがるし、QS が上がればユーザー体験が向上する (長い目で見れば収益に帰ってくる)
- Impression share
  - その配信先の全インプレッションのうち、自分の案件がでた割合。オークションの勝率のようなもの
  - Bid をあげるなりの改善をしたとして、あとどれだけボリューム増加の余地があるかの指標
  - シェアが十分あるのなら現在の設定で十分だとか、高い金額でさしているのにシェアが少ない場合はキーワードの変更を検討するなどの最適化を促す
- Overlap rate
  - どれだけ競合がいるかの指標
  - これも競争率を見てキーワードの検討を促す
  - プラットフォーム側・媒体側としても、人気キーワードだけでなくそうでないところまで収益化できるようになる
- Position above rate
  - 自分より高い順位にほかの案件が出ている割合?
  - 平均順位との違いがよくわからない
- Top of page rate
  - ページのトップに出た割合?
  - よくわからない

#### メモ

- こういうレポートはより広告主に競争を促してプラットフォームと媒体の収益性を改善する目的があるはず
- 案件そのものの金額アップや質の改善という縦の方向と、より様々なキーワードに分散させるという横の方向の改善の2種類があるように読み取れた
- 先の論文によると、Overture は競合の入札額も開示していたらしい。AdWords はそうではなく、平均値などのレポートだけを出している。
